# this Makefile generates C code for similar SHT functions,
# from one generic code + tags (reduces code maintenance).

GSH=SH_to_spat.gen.c
ST=ST_to_spat.c
S=S_to_spat.c
T=T_to_spat.c
X=SH_to_spat.c

$(X) : $(GSH) Makefile
	@echo "/// This file was automatically generated by 'make' from file '$(GSH)'." > $(ST)
	@echo "/// To modify it, please consider modifying SHTsphtor_to_spat.gen.c" >> $(ST)
	@cp $(ST) $(S)
	@cp $(ST) $(T)
	@cp $(ST) $(X)
#both Spheroidal and Toroidal components (keep all lines, removing tags)
	@sed -e "/^[#X]/d" -e "s/^[STV]//" $(GSH) >> $(ST)
#Spheroidal component only (delete lines startig with tag T, remove tag S)
	@sed -e "/^[T#X]/d" -e "s/^[SV]//" $(GSH) >> $(S)
#Toroidal component only (delete lines startig with tag S, remove tag T)
	@sed -e "/^[S#X]/d" -e "s/^[TV]//" $(GSH) >> $(T)
#Scalar component (delete lines starting with S,T,V, removing tags)
	@sed -e "/^[#STV]/d" -e "s/^X//" $(GSH) >> $(X)
	@echo "SH*_to_spat code generated."

GSP=spat_to_SH.gen.c
SC=spat_to_SH.c
VE=spat_to_SHsphtor.c	
	
$(SC) : $(GSP) Makefile
	@echo "/// This file was automatically generated by 'make' from file '$(GSP)'." > $(SC)
	@echo "/// To modify it, please consider modifying SHTsphtor_to_spat.gen.c" >> $(SC)
	@cp $(SC) $(VE)
#scalar transform (delete lines with tag V and comments (#) + remove tag X
	@sed -e "/^[V#]/d" -e "s/^X//" $(GSP) >> $(SC)
#scalar transform (delete lines with tag X and comments (#) + remove tag V
	@sed -e "/^[X#]/d" -e "s/^V//" $(GSP) >> $(VE)
	@echo "spat_to_SH* code generated."
	
