# this Makefile generates C code for 3 similar SHT functions,
# (namely SHsphtor_to_spat, SHsph_to_spat, SHtor_to_spat)
# from one generic function + tags.

GEN=ST_to_spat.gen.c
ST=ST_to_spat.c
S=S_to_spat.c
T=T_to_spat.c

$(ST) : $(GEN) Makefile
	@echo "/// This file was automatically generated by 'make' from file '$(GEN)'." > $(ST)
	@echo "/// To modify it, please consider modifying SHTsphtor_to_spat.gen.c" >> $(ST)
	@cp $(ST) $(S)
	@cp $(ST) $(T)
#both Spheroidal and Toroidal components (keep all lines, removing tags)
	@sed -e "/^#/d" -e "s/^[ST]//" $(GEN) >> $(ST)
#Spheroidal component only (delete lines startig with tag T, remove tag S)
	@sed -e "/^[T#]/d" -e "s/^S//" $(GEN) >> $(S)
#Toroidal component only (delete lines startig with tag S, remove tag T)
	@sed -e "/^[S#]/d" -e "s/^T//" $(GEN) >> $(T)
	@echo "ST_to_spat code generated."
